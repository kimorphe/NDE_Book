\documentclass[10pt,a4j,dvipdfmx]{jarticle}
%\usepackage{graphicx,wrapfig}
\usepackage{graphicx}
\usepackage{pdfpages}
\usepackage{showkeys}
\setlength{\topmargin}{-1.5cm}
%\setlength{\textwidth}{16.5cm}
\setlength{\textheight}{25.2cm}
\newlength{\minitwocolumn}
\setlength{\minitwocolumn}{0.5\textwidth}
\addtolength{\minitwocolumn}{-\columnsep}
%\addtolength{\baselineskip}{-0.1\baselineskip}
%
\def\Mmaru#1{{\ooalign{\hfil#1\/\hfil\crcr
\raise.167ex\hbox{\mathhexbox 20D}}}}
%
\begin{document}
\newcommand{\fat}[1]{\mbox{\boldmath $#1$}}
\newcommand{\D}{\partial}
\newcommand{\w}{\omega}
\newcommand{\ga}{\alpha}
\newcommand{\gb}{\beta}
\newcommand{\gx}{\xi}
\newcommand{\gz}{\zeta}
\newcommand{\vhat}[1]{\hat{\fat{#1}}}
\newcommand{\spc}{\vspace{0.7\baselineskip}}
\newcommand{\halfspc}{\vspace{0.3\baselineskip}}
\bibliographystyle{unsrt}
%\pagestyle{empty}
\newcommand{\twofig}[2]
 {
   \begin{figure}
     \begin{minipage}[t]{\minitwocolumn}
         \begin{center}   #1
         \end{center}
     \end{minipage}
         \hspace{\columnsep}
     \begin{minipage}[t]{\minitwocolumn}
         \begin{center} #2
         \end{center}
     \end{minipage}
   \end{figure}
 }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\vspace*{\baselineskip}
\begin{flushright}
	波動解析と非破壊評価\\
\end{flushright}
\begin{center}
	{\LARGE  \bf 超音波イメージング法の原理} \\
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setcounter{section}{3}
\section{問題設定}
物体中に存在するき裂や空洞などの欠陥を、超音波エコー波形から形状再構成する問題を考える。
簡単のため、無限領域内部に存在する欠陥を考え、媒体は等方線形弾性体、超音波をスカラー波として扱う。
いま、欠陥が占める領域を$D$、その境界を$\partial D$と書く。
アレイ探触子を使ったフルマトリクスキャプチャリングを想定し、
スカラー波の送受信は観測面$\cal M$内にとった$M$個の点:
\begin{equation}
	{\cal M} =\left\{ 
		\fat{y}_1, \fat{y}_2, \cdots \fat{y}_M
	\right\}
	\label{eqn:}
\end{equation}
のいずれかあるいは全てで行う。
ここで, $y_i$にあるポイントトランスミッターによって入射波を励起したときに、
$\fat{y}_j$にあるポイントレシーバで受信したAスキャン波形を$a_{ij}(t)$と表す。
%$\cal M$の内、送信点となる位置の集合を$\cal T$、受信点となる位置の集合を$\cal R$
%とすれば、観測波形データの全体は
このとき、フルマトリクスキャプチャによって得られる全波形データは
\begin{equation}
	{\cal D}= \left\{ a_{ij}(t) \left| (\fat{y}_i,\fat{y}_j)  \in {\cal M}\times {\cal M} \right.\right\}
	\label{eqn:full_mat}
\end{equation}
と表される。一方、同じ点で送受信を行うパルスエコー方で得られるデータは
\begin{equation}
	{\cal D}_0= \left\{ a_{ii}(t) \left| \fat{y}_i \in {\cal M}\right.\right\}
	\label{eqn:pulse_echo}
\end{equation}
なお、パルスエコーモードで観測された波形は、表記を簡単にするために
\begin{equation}
	a_i(t):=a_{ii}(t)
	\label{eqn:}
\end{equation}
と、2つめのインデックスを省略して書くことにする。
以下では、波形データ$\cal D$や${\cal D}_0$が与えられたときに、$D$の形状を再構成して画像として
表示する方法について説明する。
その際、画像化を行う領域を$A$、画像化点(ピクセルあるいはボクセル)を$\fat{x}$とし、
画素値を$I(\fat{x})$と表す。$I(x)$は$A$におけるスカラー関数だが、その値が取りうる範囲は
画像化手法によって異なり、正負いずれにもなり得る。また一部の方法では理論的には
有界でないものもあるが、実際に数値的に評価する場合には数値誤差や不完全なデータのために
有限な値となるため、数値解析上特異性を気にする必要はない。
\section{開口合成法}
開口合成法では次のような波形の重ね合わせで欠陥の画像を合成する。
\begin{equation}
	I(x)=\sum_{i,j}a_{ij}(t_{ij})w_iw_j
	\label{eqn:saft}
\end{equation}
ここに、$c$は位相速度を表し、
\begin{equation}
	t_{ij}(\fat{x})=\frac{r_i(\fat{x})+r_j(\fat{x})}{c}, \ \ r_i:=\left| \fat{x} -\fat{y}_i\right|
	\label{eqn:}
\end{equation}
である。なお、和の記号$\sum_{\cal D}(\cdot)$はデータ$\cal D$についての和を取ることを意味する。
実質的にはインデックス$i,j$に関する二重、あるいは一重和である。
$w_i,w_j$は、送受信センサーの指向性や感度を補正するための係数で、波動場の距離による減衰を
補償する場合には、位置$\fat{x}$に応じて与えることになる。
この定式化は発見的なものであり、この方法で再構成される画像$I(\fat{x})$の意味付けは、
別の方法との比較による必要がある。ただし、定積的な解釈は非常に簡単であり、アドホックな改善
や拡張も容易であるというメリットがある。また、点散乱体の検出に関しては、以下に見るように
どの程度の解像度を持つか、どのような計測条件が有利となるかを考察することも可能である。
%%%%%
\subsection{散乱場の積分表現}
周波数領域におけるスカラー波の散乱問題を考える．
波動場を$u(\fat{x},\omega)$とし、特に必要の無い限り角周波数$\omega$は省略する。
$u(\fat{x})$は、ヘルムホルツ方程式を満足する．
\begin{equation}
	\nabla^2 u(\fat{x}) + k^2 u(\fat{x}) =0, \ \ (\fat{x} \notin \bar{D})
	\label{eqn:}
\end{equation}
ここに、$k=\omega/c$は一定の波数を表す。
はじめに，無限領域中に置かれた散乱体$D$は，境界$\partial D$上でディリクレ条件
\begin{equation}
	u(\fat{x}) = 0, \ \ \fat{x}\in \partial D
	\label{eqn:}
\end{equation}
あるいは，ノイマン条件:
\begin{equation}
	\frac{\partial u}{\partial n} = 0 ,\ \ \fat{x}\in \partial D
	\label{eqn:}
\end{equation}
を満足する場合について考える．
散乱場を$u^{sc}(\fat{x})$，入射波$u^{in}(\fat{x})$とすると，全波動場は
\begin{equation}
	u(\fat{x})=u^{in}(\fat{x})+ u^{sc}(\fat{x})
	\label{eqn:}
\end{equation}
と表される。散乱場は放射条件を満足するものとすれば、
$u^{sc}(\fat{x})$は次のように積分表現することができる．
\begin{equation}
	u^{sc}(\fat{y}) = \int _{\partial D} 
	\left\{
		G(\fat{x},\fat{y})t(\fat{x})
	-
		H(\fat{x},\fat{y})u(\fat{x})
	\right\} dS_x
	\label{eqn:}
\end{equation}
ここで、$G(\fat{x},\fat{y})$は
\begin{equation}
	\nabla^2 G(\fat{x},\fat{y}) + k^2 G(\fat{x},\fat{y}) =-\delta (\fat{x}-\fat{y} )
	\label{eqn:}
\end{equation}
を満足する無限領域のおけるグリーン関数で、
\begin{equation}
	G(\fat{x},\fat{y}) =\frac{e^{ikr}}{4\pi r}, \ \ r=\left| \fat{x}-\fat{y} \right|
	\label{eqn:Green}
\end{equation}
で与えられる．また，
\begin{equation}
	H(\fat{x},\fat{y}) = \frac{\partial G(\fat{x},\fat{y})}{\partial n(\fat{x})}, \ \ 
	t(\fat{x}) =\frac{\partial u(\fat{x})}{\partial n(\fat{x})}
	\label{eqn:}
\end{equation}
とした。
ここで、$y=\left|\fat{y}\right|\gg \left| \fat{x} \right|$のとき、幾何光学近似
\begin{equation}
	r\sim  \fat{y}  -\hat{\fat{y}}\cdot \fat{x}, \ \ (y\rightarrow \infty)
	\label{eqn:para}
\end{equation}
を用いると、散乱場の積分表現は、Dirichlet問題，Newmann問題、それぞれの場合について
\begin{equation}
	u^{sc}(\fat{y}) \sim \frac{e^{iky}}{4\pi y} U(\hat{\fat{y}};s)  
	\label{eqn:}
\end{equation}
\begin{equation}
	U(\hat{\fat{y}};s)  = \int _{\partial D} t(\fat{x};s)e^{-ik\hat{\fat{y}}\cdot \fat{x}} dS_x
	, \ \ ( {\rm Dirichlet})
	\label{eqn:}
\end{equation}
\begin{equation}
	U(\hat{\fat{y}};s)  =-\int _{\partial D} u(\fat{x};s)e^{-ik\hat{\fat{y}}\cdot \fat{x}} dS_x
	, \ \ ({\rm Newmann})
	\label{eqn:}
\end{equation}
なお、$;$に続く$s$は入射波を指定するパラメータを表し，このように表記すること
入射波に依存した量であることを必要あ場合には明示する．
ここで、任意の$D$と場の量$f(\fat{x})$に対して次のように作用する特異関数$\gamma_D(\fat{x})$
\begin{equation}
	\int \gamma_D(\fat{x})f(\fat{x})d^3\fat{x} =\int _{\partial D} f(\fat{x}) dS
	\label{eqn:}
\end{equation}
を導入する．これを用いると、散乱振幅を
\begin{equation}
	U(\hat{\fat{y}};s)  = \int \gamma_D(\fat{x})t(\fat{x};s)e^{-ik\hat{\fat{y}}\cdot \fat{x}} dS_x
	, \ \ ( {\rm Dirichlet})
	\label{eqn:}
\end{equation}
\begin{equation}
	U(\hat{\fat{y}};s)  =-\int \gamma_D(\fat{x})u(\fat{x};s)e^{-ik\hat{\fat{y}}\cdot \fat{x}} dS_x
	, \ \ ({\rm Newmann})
	\label{eqn:}
\end{equation}
と、フーリエ積分の形式で表すことができる。

続いて，領域$D$を介在物が占める場合について考える．
ここで、介在物の外部で波数は$k_0$で一定とし、内部では一般に$k_0$とは異なる
波数となるとする。
そこで、波数を位置の関数として$k(\fat{x})$とすれば，支配方程式であるHelmholtz方程式は
\begin{equation}
	\nabla^2 u(\fat{x},\omega) + k^2(\fat{x}) u(\fat{x},\omega) =0
	\label{eqn:Hlmhlz2}
\end{equation}
となる。ここで、
\begin{equation}
	n_r(\fat{x}) =\frac{k}{k_0}
	\label{eqn:}
\end{equation}
\begin{equation}
	V(\fat{x})=n_r^2(\fat{x}-1)
	\label{eqn:}
\end{equation}
とおけば、
\begin{equation}
	k^2=k_0^2 + k_0^2 V(\fat{x})
	\label{eqn:}
\end{equation}
より、式(\ref{eqn:Hlmhlz2})は
\begin{equation}
	\nabla^2 u(\fat{x},\omega) + k_0(\fat{x}) u(\fat{x},\omega) = -k_0^2 V(\fat{x})u(\fat{x})
	\label{eqn:Hlmhlz3}
\end{equation}
と、形式上、非斉次のHelmholtz方程式の形に書き直すことができる。
従って、右辺の非斉次項を物体力項として扱えば、散乱場を次のように積分表示することができる。
\begin{equation}
	u^{sc}(\fat{y})=u(\fat{y})-u^{in}(\fat{y}) = k_0^2\int G_0(\fat{x},\fat{y})V(\fat{x})u(\fat{x}) d^3\fat{x}
	\label{eqn:LS}
\end{equation}
ここで$G_0(\fat{x},\fat{y})$は波数$k_0$をもつ均質な無限媒体に対するグリーン関数で、
式(\ref{eqn:Green})において$k=k_0$としたものである．
式(\ref{eqn:LS})はLippman-Schwinger方程式、$V(\fat{x})$は散乱ポテンシャルと呼ばれる。
散乱ポテンシャルは$D$を台に持つため、$V(\fat{x})$を求めることができれば、
散乱体形状が再構成される。
最後に、$G_0(\fat{x},\fat{y})$に幾何光学近似(\ref{eqn:para})を用いれば、
式(\ref{eqn:LS})は
\begin{equation}
	u^{sc}(\fat{y})
	=
	\frac{e^{ik_0y}}{4\pi y}
	\int
	k_0^2 V(\fat{x})u(\fat{x}) e^{-ik\hat{\fat{y}}\cdot \fat{x}}d^3\fat{x}
	\label{eqn:}
\end{equation}
となるので、
\begin{equation}
	U(\hat{\fat{y}},s)
	=
	\int
	k_0^2 V(\fat{x})u(\fat{x};s) e^{-ik\hat{\fat{y}}\cdot \fat{x}}d^3\fat{x}
	\label{eqn:U_vol}
\end{equation}
とすることで、散乱場を表面散乱体の場合と同じ形式に表すことができる。
%
\subsection{線形化逆散乱解析}
散乱体$D$に平面波:
\begin{equation}
	u^{in}(\fat{x})= e^{ik_0\fat{p}\cdot\fat{x}}
	\label{eqn:}
\end{equation}
を入射したときの$U(\hat{\fat{y}};s)$を
\begin{equation}
	u^{\infty}(\hat{\fat{y}};\fat{p})=U(\hat{\fat{y}};\fat{p})
	\label{eqn:}
\end{equation}
と表し、これを散乱振幅と呼ぶ．
ここで、$\fat{p}$は入射平面波の伝播方向を表す単位ベクトルを意味する。
このとき、式(\ref{eqn:U_vol})にBorn近似を用いると、$u(\fat{x})\simeq u^{in}(\fat{x})$
として、散乱振幅は
\begin{equation}
	u^{\infty}(\hat{\fat{y}},\fat{p})
	=
	\int
	k_0^2 V(\fat{x}) e^{-ik(\hat{\fat{y}}-\fat{p} )\cdot \fat{x}}d^3\fat{x}
	\label{eqn:U_Born}
\end{equation}
となる。散乱ポテンシャル$V(\fat{x})$のフーリエ変換を
\begin{equation}
	\tilde V(\fat{k}) = \int V(\fat{x}) e^{i\fat{k}\cdot \fat{x}} d^3\fat{x}
	\label{eqn:Vk}
\end{equation}
とすれば、式$\ref{eqn:U_Born}$は
\begin{equation}
	u^{\infty}(\hat{\fat{y}},\fat{p}) =k_0^2 \tilde V (
	k(\hat{\fat{y}}-\fat{p} )
	)
	\label{eqn:}
\end{equation}
となることから、散乱振幅は散乱ポテンシャルの波数ベクトル$k(\hat{\fat{y}}-\fat{x})$
のスペクトル成分であることが分かる．
従って、送受信条件や周波数帯域を適切に設定して波数スペクトル一定の範囲と密度でサンプリング
して逆フーリエ変換
\begin{equation}
	V(\fat{x}) =\frac{1}{(2\pi)^3} \int k_0^{-2} u^{\infty}(\hat{\fat{y}};\fat{p}) 
	e^{i\fat{k}\cdot \fat{x}}d^3\fat{k}
	\label{eqn:Vx}
\end{equation}
を評価すれば、散乱ポテンシャルを再構成することができる。
式(\ref{eqn:Vk})における波数ベクトル$\fat{k}$が
\begin{equation}
	\fat{k}=k(\hat{\fat{y}}-\fat{p})
	\label{eqn:}
\end{equation}
は、角周波数$\omega$, 観測方向$\hat{\fat{y}}$と入射方向$\fat{p}$の関数である。
いま、$\omega$と$\fat{p}$を固定し、観測方向だけを自由に取ることができる場合を
考えると、$\fat{k}$は波数空間で、図**に示したような半径$k$球を描き、
これをEvald球と呼ぶ。つまり、観測方向だけを変化させて観測した場合、
散乱ポテンシャルのEvald球状の成分だけしか得られない。一方、
観測方向に加えて、入射方向も任意に選べる場合は、Evald球は、原点を中心として
半径$2k$の球表面と内部を履き、これをEvald limitting sphere(Evald限界球)と呼ぶ。
従って、任意に\\

ここで,散乱振幅を
\begin{equation}
	u^{\infty}(\hat{\fat{y}};\fat{p})=4\pi ye^{-iky} u^{sc}(\fat{y})
	\label{eqn:}
\end{equation}
として、観測波形データ$u^{sc}$を用いて書くと式(\ref{eqn:Vx})は
\begin{equation}
	V(\fat{x}) =\frac{1}{2\pi^2} \int k_0^{-2} yu^{sc}(\fat{y})
	e^{i\fat{k}\cdot \fat{x}-iky}d^3\fat{k}, 
	\ \ (\fat{k}=k(\hat{\fat{y}}-\fat{p}))
	\label{eqn:Vx}
\end{equation}
となる。
\begin{figure}[h]
	\begin{center}
	\includegraphics[width=0.6\linewidth]{Figs/setup.eps} 
	\end{center}
	\caption{無限領域におけるスカラー波の散乱問題.} 
	\label{fig:}
\end{figure}
\begin{figure}[h]
	\begin{center}
	\includegraphics[width=0.6\linewidth]{Figs/Evald.eps} 
	\end{center}
	\caption{波数ベクトル空間におけるEvaldおよびEvald limitting sphere.} 
	\label{fig:Evald}
\end{figure}
\subsection{時間領域における再構成式}
\begin{equation}
	u^{in}(\fat{x})= F(\omega) e^{ik_0\fat{p}\cdot(\fat{x}-\fat{z})}
	\label{eqn:}
\end{equation}
を入射する場合について考える。
このとき、散乱場は
\begin{equation}
	u^{\rm sc}(\fat{y})= \frac{e^{ik(y-\fat{p}\cdot \fat{z})}}{4\pi y }F(\omega)U(\hat{\fat{y}};\fat{p}) 
	\label{eqn:}
\end{equation}
と書くことができるので、散乱ポテンシャルは
\begin{equation}
	V(\fat{x}) =\frac{1}{2\pi^2} \int k_0^{-2} \frac{u^{sc}(\fat{y})}{F(\omega)}
	e^{i\fat{k}\cdot \fat{x}-iky+ik\fat{p}\cdot\fat{z}}d^3\fat{k}
	\label{eqn:}
\end{equation}
\begin{equation}
	a(\fat{y},t):=\frac{1}{2\pi} \int \frac{u^{sc}(\fat{y})}{F(\omega)}e^{-i\omega t}d\omega
	\label{eqn:}
\end{equation}
\begin{equation}
	V(\fat{x}) =\frac{1}{2\pi^2} y\int a\left(\fat{y}, t_{in}+t_{sc} \right) d\Omega
	\label{eqn:}
\end{equation}
\begin{equation}
	\fat{k}=k(\hat{\fat{y}}-\fat{p}) 
	\label{eqn:}
\end{equation}
\begin{equation}
	\hat{\fat{y}}=(\sin\theta\cos\phi,\sin\theta\sin\phi, \cos\theta)
	\label{eqn:}
\end{equation}
\begin{equation}
	d^3\fat{k}=k^2\sin\theta (1-\hat{\fat{y}}\cdot\fat{p})dkd\theta d\phi
	\label{eqn:}
\end{equation}
\begin{equation}
	\hat{\fat{k}}= \frac{\fat{k}}{\left| \fat{k}\right|}
	\label{eqn:}
\end{equation}
\begin{equation}
	d^3\fat{k}=2k^2\sin\theta\sin\frac{\delta}{2} dkd\theta d\phi\\
	\label{eqn:}
\end{equation}
\begin{equation}
	\hat{\fat{k}}=(\sin\theta\cos\phi,\sin\theta\sin\phi, \cos\theta)
	\label{eqn:}
\end{equation}
\begin{equation}
	\cos\delta=\hat{\fat{y}}\cdot\fat{p}
	\label{eqn:}
\end{equation}
\end{document}
